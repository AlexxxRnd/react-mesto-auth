(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,n){e.exports=n.p+"static/media/logo.400f7dde.svg"},17:function(e,t,n){e.exports=n.p+"static/media/loading.be00fc4a.svg"},18:function(e,t,n){e.exports=n.p+"static/media/trash.4220563a.svg"},19:function(e,t,n){e.exports=n.p+"static/media/ok.e38b395c.svg"},20:function(e,t,n){e.exports=n.p+"static/media/err.4072126c.svg"},25:function(e,t,n){e.exports=n(99)},34:function(e,t,n){},99:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(13),r=n.n(c),i=(n(34),n(23)),l=n(2),u=n(1),s=n(24),m=function(e){var t=e.component,n=Object(s.a)(e,["component"]);return o.a.createElement(u.b,null,function(){return n.loggedIn?o.a.createElement(t,n):o.a.createElement(u.a,{to:"./sign-in"})})},p=n(7),d=n(16),_=n.n(d);var f=function(e){var t=e.loggedIn,n=e.onSignOut,a=e.userEmail,c=Object(u.h)();return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:_.a,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f"}),"/sign-in"===c.pathname&&o.a.createElement(p.b,{to:"/sign-up",className:"header__login-btn"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),"/sign-up"===c.pathname&&o.a.createElement(p.b,{to:"/sign-in",className:"header__login-btn"},"\u0412\u043e\u0439\u0442\u0438"),t&&o.a.createElement("div",{className:"header__user-email"},a,o.a.createElement("button",{className:"header__signout-btn",onClick:n},"\u0412\u044b\u0439\u0442\u0438")))};var h=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"AlexR\xa9 ",(new Date).getFullYear()," Mesto Russia"))},g=n(17),b=n.n(g),E=n(18),v=n.n(E),C=o.a.createContext();var N=function(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,c=e.onCardDelete,r=o.a.useContext(C),i=t.owner._id===r._id,l=t.likes.some(function(e){return e._id===r._id}),u="element__like-btn ".concat(l?"element__like-btn_active":""),s="element__delete-btn ".concat(i?"element__delete-btn_visible":"element__delete-btn_hidden");return o.a.createElement("article",{className:"element"},o.a.createElement("button",{"aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",className:s,type:"button",onClick:function(){c(t)}},o.a.createElement("img",{src:v.a,alt:"\u0443\u0434\u0430\u043b\u0438\u0442\u044c",className:"element__trash"})),o.a.createElement("img",{className:"element__photo",src:t.link,alt:t.name,onClick:function(){n(t)}}),o.a.createElement("div",{className:"element__info"},o.a.createElement("h2",{className:"element__title"},t.name),o.a.createElement("div",{className:"element__like-container"},o.a.createElement("button",{"aria-label":"\u041e\u0446\u0435\u043d\u0438\u0442\u044c",className:u,type:"button",onClick:function(){a(t)}}),o.a.createElement("p",{className:"element__like-count"},t.likes.length))))};var k=function(e){var t=e.onEditProfile,n=e.onAddPlace,a=e.onEditAvatar,c=e.onCardClick,r=e.cards,i=e.onCardLike,l=e.onCardDelete,u=o.a.useContext(C);return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("img",{className:"profile__avatar",src:u.avatar?u.avatar:b.a,alt:"\u0430\u0432\u0430\u0442\u0430\u0440"}),o.a.createElement("button",{className:"profile__avatar-edit-btn",onClick:a}),o.a.createElement("div",{className:"profile__info"},o.a.createElement("h1",{className:"profile__name"},u.name?u.name:"\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."),o.a.createElement("button",{"aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e",className:"profile__edit-btn",type:"button",onClick:t}),o.a.createElement("h2",{className:"profile__subname"},u.about?u.about:"\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430...")),o.a.createElement("button",{"aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e",className:"profile__add-btn",type:"button",onClick:n})),o.a.createElement("section",{className:"elements"},r.map(function(e){return o.a.createElement(N,{card:e,onCardClick:c,onCardLike:i,onCardDelete:l,key:e._id})})))};var y=Object(u.i)(function(e){var t=e.onRegister,n=e.loggedIn,a=Object(u.g)(),c=o.a.useState(""),r=Object(l.a)(c,2),i=r[0],s=r[1],m=o.a.useState(""),d=Object(l.a)(m,2),_=d[0],f=d[1];return n&&a.push("/"),o.a.createElement("main",{className:"content"},o.a.createElement("form",{className:"account__form"},o.a.createElement("h2",{className:"account__title"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),o.a.createElement("input",{className:"account__input",name:"email",type:"email",placeholder:"Email",required:"",value:i||"",onChange:function(e){s(e.target.value)}}),o.a.createElement("input",{className:"account__input",name:"password",type:"text",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:"",value:_||"",onChange:function(e){f(e.target.value)}}),o.a.createElement("button",{className:"account__submit-btn",type:"button",onClick:function(e){e.preventDefault(),t({email:i,password:_})}},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),o.a.createElement(p.b,{to:"/sign-in",className:"account__subtitle"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438")))});var O=function(e){var t=e.onLogin,n=e.loggedIn,a=Object(u.g)(),c=o.a.useState(""),r=Object(l.a)(c,2),i=r[0],s=r[1],m=o.a.useState(""),p=Object(l.a)(m,2),d=p[0],_=p[1];return n&&a.push("/"),o.a.createElement("main",{className:"content"},o.a.createElement("form",{className:"account__form"},o.a.createElement("h2",{className:"account__title"},"\u0412\u0445\u043e\u0434"),o.a.createElement("input",{className:"account__input",name:"email",type:"email",placeholder:"Email",required:"",value:i||"",onChange:function(e){s(e.target.value)}}),o.a.createElement("input",{className:"account__input",name:"password",type:"text",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:"",value:d||"",onChange:function(e){_(e.target.value)}}),o.a.createElement("button",{className:"account__submit-btn",type:"button",onClick:function(e){e.preventDefault(),t({email:i,password:d})}},"\u0412\u043e\u0439\u0442\u0438")))};var j=function(e){return o.a.createElement("div",{className:"popup ".concat(e.isOpen?"popup_opened":""),id:"popup_".concat(e.name)},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",className:"popup__close-btn",type:"button",onClick:e.onClose}),o.a.createElement("form",{className:"popup__form",name:e.name,onSubmit:e.onSubmit},o.a.createElement("h2",{className:"popup__title"},e.title),e.children,o.a.createElement("button",{className:"popup__save-btn",type:"submit"},e.buttonText))))};var S=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,c=o.a.useContext(C),r=o.a.useState(""),i=Object(l.a)(r,2),u=i[0],s=i[1],m=o.a.useState(""),p=Object(l.a)(m,2),d=p[0],_=p[1];return o.a.useEffect(function(){s(c.name),_(c.about)},[c,t]),o.a.createElement(j,{name:"editProfile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:u,about:d})}},o.a.createElement("input",{className:"popup__input popup__input_type_name",id:"name-input",name:"name",type:"text",placeholder:"\u0418\u043c\u044f",minLength:2,maxLength:40,required:"",value:u||"",onChange:function(e){s(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error name-input-error"}),o.a.createElement("input",{className:"popup__input popup__input_type_job",id:"job-input",name:"about",type:"text",placeholder:"\u041e \u0441\u0435\u0431\u0435",minLength:2,maxLength:200,required:"",value:d||"",onChange:function(e){_(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error job-input-error"}))};var x=function(e){var t=e.isOpen,n=e.onClose,a=e.onAddCard,c=o.a.useState(""),r=Object(l.a)(c,2),i=r[0],u=r[1],s=o.a.useState(""),m=Object(l.a)(s,2),p=m[0],d=m[1];return o.a.useEffect(function(){u(""),d("")},[t]),o.a.createElement(j,{name:"addCard",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:i,link:p})}},o.a.createElement("input",{className:"popup__input popup__input_type_mesto-name",id:"mesto-input",name:"name",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:2,maxLength:30,required:"",value:i||"",onChange:function(e){u(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error mesto-input-error"}),o.a.createElement("input",{className:"popup__input popup__input_type_url",id:"url-input",name:"link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:"",value:p||"",onChange:function(e){d(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error url-input-error"}))};var I=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,c=o.a.useState(""),r=Object(l.a)(c,2),i=r[0],u=r[1];return o.a.createElement(j,{name:"edit_avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({avatar:i})}},o.a.createElement("input",{className:"popup__input popup__input_type_avatar",id:"avatar",name:"avatar",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:"",value:i||"",onChange:function(e){u(e.target.value)}}),o.a.createElement("span",{className:"popup__input-error avatar-error"}))};var T=function(e){var t=e.card,n=e.onClose;return o.a.createElement("div",{className:"popup popup_img-open ".concat(t.link?"popup_opened":""),id:"popup_img"},o.a.createElement("div",{className:"popup__container-img"},o.a.createElement("button",{"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",className:"popup__close-btn",type:"button",onClick:n}),o.a.createElement("img",{className:"popup__image",src:t.link,alt:t.name}),o.a.createElement("h2",{className:"popup__title-img"},t.name)))},w=n(19),L=n.n(w),P=n(20),A=n.n(P);var R=function(e){return o.a.createElement("div",{className:"popup ".concat(e.isOpen?"popup_opened":"")},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",className:"popup__close-btn",type:"button",onClick:e.onClose}),o.a.createElement("form",{className:"popup__form",name:e.name},o.a.createElement("img",{className:"infotooltip__logo",src:e.isSuccess?L.a:A.a}),o.a.createElement("h2",{className:"infotooltip__message"},e.isSuccess?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."))))},D=n(21),U=n(22),q=new(function(){function e(t){Object(D.a)(this,e),this._url=t.url,this._header=t.header}return Object(U.a)(e,[{key:"_getResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._url,"/cards"),{headers:this._header}).then(function(t){return e._getResponse(t)})}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"/users/me"),{headers:this._header}).then(function(t){return e._getResponse(t)})}},{key:"setUserInfo",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._header,body:JSON.stringify({name:e.name,about:e.about})}).then(function(e){return t._getResponse(e)})}},{key:"setUserAvatar",value:function(e){var t=this;return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._header,body:JSON.stringify({avatar:e.avatar})}).then(function(e){return t._getResponse(e)})}},{key:"addCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._header,body:JSON.stringify({name:e.name,link:e.link})}).then(function(e){return t._getResponse(e)})}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._header}).then(function(e){return t._getResponse(e)})}},{key:"likeCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"PUT",headers:this._header}).then(function(e){return t._getResponse(e)})}},{key:"unlikeCard",value:function(e){var t=this;return fetch("".concat(this._url,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._header}).then(function(e){return t._getResponse(e)})}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-41",header:{authorization:"6e85cbb9-d07a-454d-87dc-f5801edbeaad","Content-Type":"application/json"}}),J="https://auth.nomoreparties.co",F=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},B=function(e,t){return fetch("".concat(J,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e,t)}).then(function(e){return F(e)})},z=function(e,t){return fetch("".concat(J,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e,t)}).then(function(e){return F(e)})},H=function(e){return fetch("".concat(J,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(function(e){return F(e)})};var M=function(){var e=o.a.useState(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],c=o.a.useState(!1),r=Object(l.a)(c,2),s=r[0],p=r[1],d=o.a.useState(!1),_=Object(l.a)(d,2),g=_[0],b=_[1],E=o.a.useState(!1),v=Object(l.a)(E,2),N=v[0],j=v[1],w=o.a.useState({}),L=Object(l.a)(w,2),P=L[0],A=L[1],D=o.a.useState({}),U=Object(l.a)(D,2),J=U[0],F=U[1],M=o.a.useState([]),G=Object(l.a)(M,2),Y=G[0],K=G[1],Q=o.a.useState(!1),V=Object(l.a)(Q,2),W=V[0],X=V[1],Z=o.a.useState(""),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=o.a.useState(!1),ae=Object(l.a)(ne,2),oe=ae[0],ce=ae[1],re=Object(u.g)();function ie(){j(!0)}function le(){a(!1),p(!1),b(!1),j(!1),A({})}function ue(){var e=localStorage.getItem("jwt");e&&H(e).then(function(e){te(e.data.email),X(!0),re.push("/")}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})}o.a.useEffect(function(){Promise.all([q.getUserInfo(),q.getInitialCards()]).then(function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];F(n),K(a)}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})},[]),o.a.useEffect(function(){ue()},[]),o.a.useEffect(function(){W&&re.push("/")},[W]);var se=n||s||g||P.link;return o.a.useEffect(function(){function e(e){"Escape"===e.key&&le()}if(se)return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[se]),o.a.createElement(C.Provider,{value:J},o.a.createElement("div",{className:"page"},o.a.createElement(f,{loggedIn:W,onSignOut:function(){X(!1),localStorage.removeItem("jwt"),te(""),re.push("/sign-in")},userEmail:ee}),o.a.createElement(u.d,null,o.a.createElement(u.b,{path:"/sign-up"},o.a.createElement(y,{loggedIn:W,onRegister:function(e,t){B(e,t).then(function(){ce(!0),ie(),re.push("/sign-in")}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e)),ce(!1),ie()})}})),o.a.createElement(u.b,{path:"/sign-in"},o.a.createElement(O,{loggedIn:W,onLogin:function(e,t){z(e,t).then(function(e){X(!0),localStorage.setItem("jwt",e.token),ue(),re.push("/")}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e)),X(!1),ce(!1),ie()})}})),o.a.createElement(m,{path:"/",loggedIn:W,component:k,onEditAvatar:function(){a(!n)},onEditProfile:function(){p(!s)},onAddPlace:function(){b(!g)},onClose:le,onCardClick:function(e){A(e)},cards:Y,onCardLike:function(e){e.likes.some(function(e){return e._id===J._id})?q.unlikeCard(e._id).then(function(t){K(function(n){return n.map(function(n){return n._id===e._id?t:n})})}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}):q.likeCard(e._id).then(function(t){K(function(n){return n.map(function(n){return n._id===e._id?t:n})})}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})},onCardDelete:function(e){q.deleteCard(e._id).then(function(){K(function(t){return t.filter(function(t){return t._id!==e._id})})}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})}})),o.a.createElement(h,null),o.a.createElement(S,{isOpen:s,onClose:le,onUpdateUser:function(e,t){q.setUserInfo(e,t).then(function(e){F(e),le()}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})}}),o.a.createElement(x,{isOpen:g,onClose:le,onAddCard:function(e){q.addCard(e).then(function(e){K([e].concat(Object(i.a)(Y))),le()}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})}}),o.a.createElement(I,{isOpen:n,onClose:le,onUpdateAvatar:function(e){q.setUserAvatar(e).then(function(e){F(e),le()}).catch(function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))})}}),o.a.createElement(T,{card:P,onClose:le}),o.a.createElement(R,{onClose:le,isOpen:N,isSuccess:oe})))},G=function(e){e&&e instanceof Function&&n.e(1).then(n.bind(null,100)).then(function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),c(e),r(e)})};r.a.createRoot(document.getElementById("root")).render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(p.a,null,o.a.createElement(M,null)))),G()}},[[25,3,2]]]);
//# sourceMappingURL=main.082f957d.chunk.js.map